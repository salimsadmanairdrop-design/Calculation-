<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Meal Accounts</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    margin:0;
    padding:10px;
}
.container{
    background:#fff;
    padding:15px;
    max-width:1200px;
    margin:auto;
}
h2,h4{text-align:center;margin:6px 0;}

input{
    width:100%;
    padding:5px;
    font-size:13px;
    box-sizing:border-box;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}
th,td{
    border:1px solid #ccc;
    padding:5px;
    text-align:center;
    font-size:13px;
}
th{
    background:#1abc9c;
    color:#fff;
}

.btn{
    padding:8px 14px;
    border:none;
    background:#1abc9c;
    color:#fff;
    border-radius:4px;
    cursor:pointer;
    margin:5px 0;
}

tfoot tr{
    background:#e0f2f1;
    font-weight:bold;
}

.footer{
    text-align:center;
    margin-top:15px;
    font-size:13px;
}
.footer a{
    color:#000;
    text-decoration:none;
}
</style>
</head>

<body>

<div class="container" id="pdfArea">

<h2>Accounts of Meal</h2>

<h4>
Month: 
<input type="text" id="month" value="December 2025" style="width:180px;text-align:center;">
&nbsp;&nbsp;&nbsp;
Meal Rate: 
<input type="number" id="mealRate" value="46" style="width:80px;" oninput="updateAllRates()">
</h4>

<table id="mealTable">
<thead>
<tr>
<th>Sl</th>
<th>Name</th>
<th>Meal</th>
<th>Rate</th>
<th>Meal Cost</th>
<th>Fixed</th>
<th>Total</th>
<th>Deposit</th>
<th>Due</th>
</tr>
</thead>
<tbody>
</tbody>
<tfoot>
<tr>
<td colspan="2">Total</td>
<td id="sumMeal">0</td>
<td>—</td>
<td id="sumMealCost">0</td>
<td id="sumFixed">0</td>
<td id="sumTotal">0</td>
<td id="sumDeposit">0</td>
<td id="sumDue">0</td>
</tr>
</tfoot>
</table>

<div class="footer">
© Developed by 
<a href="https://www.facebook.com/salimsadmanshoron" target="_blank">
SALIM SADMAN SHORON
</a>
</div>

</div>

<button class="btn" onclick="addRow()">Add New Member</button>
<button class="btn" onclick="downloadPDF()">Download PDF</button>

<script>
const tbody = document.querySelector("#mealTable tbody");

// Add row function
function addRow(){
    let sl = tbody.rows.length + 1;
    let row = tbody.insertRow();
    row.innerHTML = `
    <td>${sl}</td>
    <td><input type="text" maxlength="20" oninput="updateFooter()"></td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td class="rateCell">${document.getElementById("mealRate").value}</td>
    <td>0</td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td>0</td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td>0</td>
    `;
}

// Calc function
function calc(el){
    const row = el.closest("tr");
    const meal = Number(row.cells[2].children[0].value || 0);
    const rate = Number(document.getElementById("mealRate").value);
    const fixed = Number(row.cells[5].children[0].value || 0);
    const deposit = Number(row.cells[7].children[0].value || 0);

    const mealCost = meal * rate;
    const total = mealCost + fixed;
    const due = total - deposit;

    row.cells[3].innerText = rate;
    row.cells[4].innerText = mealCost;
    row.cells[6].innerText = total;
    row.cells[8].innerText = due;

    updateFooter();
}

// Update all rates
function updateAllRates(){
    Array.from(tbody.rows).forEach(row => {
        calc(row.cells[2].children[0]);
    });
}

// Update footer totals
function updateFooter(){
    let sumMeal=0,sumMealCost=0,sumFixed=0,sumTotal=0,sumDeposit=0,sumDue=0;
    Array.from(tbody.rows).forEach(row=>{
        sumMeal += Number(row.cells[2].children[0]?.value || 0);
        sumMealCost += Number(row.cells[4].innerText || 0);
        sumFixed += Number(row.cells[5].children[0]?.value || 0);
        sumTotal += Number(row.cells[6].innerText || 0);
        sumDeposit += Number(row.cells[7].children[0]?.value || 0);
        sumDue += Number(row.cells[8].innerText || 0);
    });
    document.getElementById("sumMeal").innerText = sumMeal;
    document.getElementById("sumMealCost").innerText = sumMealCost;
    document.getElementById("sumFixed").innerText = sumFixed;
    document.getElementById("sumTotal").innerText = sumTotal;
    document.getElementById("sumDeposit").innerText = sumDeposit;
    document.getElementById("sumDue").innerText = sumDue;
}

// default 17 members
for(let i=0;i<17;i++) addRow();

// Download PDF
function downloadPDF(){
    html2pdf().from(document.getElementById("pdfArea")).set({
        margin:6,
        filename:"meal_accounts.pdf",
        html2canvas:{scale:2},
        jsPDF:{orientation:"landscape"}
    }).save();
}
</script>

</body>
</html>
