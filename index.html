<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Meal Accounts</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    margin:0;
    padding:10px;
}
.container{
    background:#fff;
    padding:15px;
    max-width:1200px;
    margin:auto;
}
h2,h4{text-align:center;margin:6px 0;}

input{
    width:100%;
    padding:5px;
    font-size:13px;
    box-sizing:border-box;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}
th,td{
    border:1px solid #ccc;
    padding:5px;
    text-align:center;
    font-size:13px;
}
th{
    background:#1abc9c;
    color:#fff;
}

.btn{
    padding:8px 14px;
    border:none;
    background:#1abc9c;
    color:#fff;
    border-radius:4px;
    cursor:pointer;
    margin:5px 0;
}

.footer{
    text-align:center;
    margin-top:15px;
    font-size:13px;
}
.footer a{
    color:#000;
    text-decoration:none;
}
</style>
</head>

<body>

<div class="container" id="pdfArea">

<h2>Accounts of Meal</h2>

<h4>
Month: 
<input type="text" id="month" value="December 2025" style="width:180px;text-align:center;">
&nbsp;&nbsp;&nbsp;
Meal Rate: 
<input type="number" id="mealRate" value="46" style="width:80px;" oninput="updateAllRates()">
</h4>

<table id="mealTable">
<thead>
<tr>
<th>Sl</th>
<th>Name</th>
<th>Meal</th>
<th>Rate</th>
<th>Meal Cost</th>
<th>Fixed</th>
<th>Total</th>
<th>Deposit</th>
<th>Due</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<div class="footer">
Â© Developed by 
<a href="https://www.facebook.com/salimsadmanshoron" target="_blank">
SALIM SADMAN SHORON
</a>
</div>

</div>

<button class="btn" onclick="addRow()">Add New Member</button>
<button class="btn" onclick="downloadPDF()">Download PDF</button>

<script>
const tbody = document.querySelector("#mealTable tbody");

function addRow(){
    let sl = tbody.rows.length + 1;
    let row = tbody.insertRow();

    row.innerHTML = `
    <td>${sl}</td>
    <td><input type="text" maxlength="20"></td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td class="rateCell">${document.getElementById("mealRate").value}</td>
    <td>0</td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td>0</td>
    <td><input type="number" min="0" oninput="calc(this)"></td>
    <td>0</td>
    `;
}

function calc(el){
    const row = el.closest("tr");
    const meal = Number(row.cells[2].children[0].value || 0);
    const rate = Number(document.getElementById("mealRate").value);
    const fixed = Number(row.cells[5].children[0].value || 0);
    const deposit = Number(row.cells[7].children[0].value || 0);

    const mealCost = meal * rate;
    const total = mealCost + fixed;
    const due = total - deposit;

    row.cells[3].innerText = rate;
    row.cells[4].innerText = mealCost;
    row.cells[6].innerText = total;
    row.cells[8].innerText = due;
}

// Update all rates when top input changes
function updateAllRates(){
    const rate = Number(document.getElementById("mealRate").value);
    Array.from(tbody.rows).forEach(row => {
        calc(row.cells[2].children[0]);
    });
}

// default 17 members
for(let i=0;i<17;i++) addRow();

function downloadPDF(){
    html2pdf().from(document.getElementById("pdfArea")).set({
        margin:6,
        filename:"meal_accounts.pdf",
        html2canvas:{scale:2},
        jsPDF:{orientation:"landscape"}
    }).save();
}
</script>

</body>
</html>
